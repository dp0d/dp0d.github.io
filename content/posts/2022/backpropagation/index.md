---
title: "åå‘ä¼ æ’­ç®—æ³•"
date: 2022-03-18T11:29:42+08:00
math: true
draft: false
---

# åå‘ä¼ æ’­ç®—æ³•

ä½œä¸ºä¸€ä½æœºå™¨å­¦ä¹ é¢†åŸŸçš„åšä¸»ï¼Œç¬¬ä¸€ç¯‡åšå®¢è‚¯å®šè¦ä»åå‘ä¼ æ’­ç®—æ³•å¼€å§‹å•¦~

## ç®€ä»‹

â€‹	æ¥è‡ª[ç»´åŸºç™¾ç§‘](https://zh.wikipedia.org/wiki/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95#cite_note-Alpaydin2010-10)

â€‹	é¦–å…ˆæ˜¯åå‘ä¼ æ’­ç®—æ³•çš„å†å²æ²¿ç”¨ğŸ‘‡

â€‹	[å¼—æ‹‰åŸºç±³å°”Â·ç“¦æ™®å°¼å…‹](https://zh.wikipedia.org/wiki/å¼—æ‹‰åŸºç±³å°”Â·ç“¦æ™®å°¼å…‹)å¼•ç”¨ï¼ˆBryson, A.E.; W.F. Denham; S.E. Dreyfus. Optimal programming problems with inequality constraints. I: Necessary conditions for extremal solutions. AIAA J. 1, 11 (1963) 2544-2550ï¼‰åœ¨ä»–çš„ä¹¦ã€Šæ”¯æŒå‘é‡æœºã€‹ä¸­é¦–æ¬¡å‘è¡¨åå‘ä¼ æ’­ç®—æ³•ã€‚åœ¨1969å¹´[Arthur E. Bryson](https://zh.wikipedia.org/w/index.php?title=Arthur_E._Bryson&action=edit&redlink=1)å’Œ[ä½•æ¯“ç¦](https://zh.wikipedia.org/wiki/ä½•æ¯“ç¦)å°†å…¶æè¿°ä¸ºå¤šçº§åŠ¨æ€ç³»ç»Ÿä¼˜åŒ–æ–¹æ³•ã€‚ç›´åˆ°1974å¹´ä»¥ååœ¨ç¥ç»ç½‘ç»œçš„èƒŒæ™¯ä¸‹åº”ç”¨ï¼Œå¹¶ç”±[Paul Werbos](https://zh.wikipedia.org/w/index.php?title=Paul_Werbos&action=edit&redlink=1)[[7\]](https://zh.wikipedia.org/wiki/åå‘ä¼ æ’­ç®—æ³•#cite_note-9)ã€[David E. Rumelhart](https://zh.wikipedia.org/w/index.php?title=David_E._Rumelhart&action=edit&redlink=1)ã€[æ°å¼—é‡ŒÂ·è¾›é¡¿](https://zh.wikipedia.org/wiki/æ°å¼—é‡ŒÂ·è¾›é¡¿)å’Œ[Ronald J. Williams](https://zh.wikipedia.org/w/index.php?title=Ronald_J._Williams&action=edit&redlink=1)[[1\]](https://zh.wikipedia.org/wiki/åå‘ä¼ æ’­ç®—æ³•#cite_note-Rumelhart1986-1)[[8\]](https://zh.wikipedia.org/wiki/åå‘ä¼ æ’­ç®—æ³•#cite_note-Alpaydin2010-10)çš„è‘—ä½œï¼Œå®ƒæ‰è·å¾—è®¤å¯ï¼Œå¹¶å¼•å‘äº†ä¸€åœºäººå·¥ç¥ç»ç½‘ç»œçš„ç ”ç©¶é¢†åŸŸçš„â€œæ–‡è‰ºå¤å…´â€ã€‚åœ¨21ä¸–çºªåˆäººä»¬å¯¹å…¶å¤±å»å…´è¶£ï¼Œä½†åœ¨2010å¹´ååˆæ‹¥æœ‰äº†å…´è¶£ï¼Œå¦‚ä»Šå¯ä»¥é€šè¿‡[GPU](https://zh.wikipedia.org/wiki/åœ–å½¢è™•ç†å™¨)ç­‰å¤§å‹ç°ä»£è¿ç®—å™¨ä»¶ç”¨äºè®­ç»ƒæ›´å¤§çš„ç½‘ç»œã€‚ä¾‹å¦‚åœ¨2013å¹´ï¼Œé¡¶çº§è¯­éŸ³è¯†åˆ«å™¨ç°åœ¨ä½¿ç”¨åå‘ä¼ æ’­ç®—æ³•è®­ç»ƒç¥ç»ç½‘ç»œã€‚

â€‹	é‚£ä¹ˆåå‘ä¼ æ’­ç®—æ³•æ˜¯å•¥ï¼ŸğŸ‘‡

â€‹	**åå‘ä¼ æ’­**ï¼ˆè‹±è¯­ï¼šBackpropagationï¼Œç¼©å†™ä¸º**BP**ï¼‰æ˜¯â€œè¯¯å·®åå‘ä¼ æ’­â€çš„ç®€ç§°ï¼Œæ˜¯ä¸€ç§ä¸[æœ€ä¼˜åŒ–æ–¹æ³•](https://zh.wikipedia.org/wiki/æœ€ä¼˜åŒ–)ï¼ˆå¦‚[æ¢¯åº¦ä¸‹é™æ³•](https://zh.wikipedia.org/wiki/æ¢¯åº¦ä¸‹é™æ³•)ï¼‰ç»“åˆä½¿ç”¨çš„ï¼Œç”¨æ¥è®­ç»ƒ[äººå·¥ç¥ç»ç½‘ç»œ](https://zh.wikipedia.org/wiki/äººå·¥ç¥ç»ç½‘ç»œ)çš„å¸¸è§æ–¹æ³•ã€‚è¯¥æ–¹æ³•å¯¹ç½‘ç»œä¸­æ‰€æœ‰æƒé‡è®¡ç®—[æŸå¤±å‡½æ•°](https://zh.wikipedia.org/wiki/æŸå¤±å‡½æ•°)çš„æ¢¯åº¦ã€‚è¿™ä¸ªæ¢¯åº¦ä¼šå›é¦ˆç»™æœ€ä½³åŒ–æ–¹æ³•ï¼Œç”¨æ¥æ›´æ–°æƒå€¼ä»¥æœ€å°åŒ–æŸå¤±å‡½æ•°ã€‚

## å‰å‘ä¼ æ’­æ¨å¯¼

### a. äº†è§£çŸ©é˜µä¹˜æ³•

å‡è®¾ğŸ‘‡

{{< math >}}

$$
\textbf{A} =

\begin{bmatrix}
1 & 2 \\
3 & 4 \\
\end{bmatrix}
\quad
\textbf{B}=\left[
    \begin{matrix}
	-1 & -2 \\
	-3 & -4 \\
    \end{matrix}
\right]
$$

{{< /math >}}



**ç‚¹ç§¯**ï¼ˆé€šå¸¸çœç•¥  Â·   ç¬¦å·ï¼‰è®¡ç®—å¦‚ä¸‹ğŸ‘‡

{{< math >}}
$$
\textbf{AB} =
\left[
	\begin{matrix}
	1 \times(-1) + 2\times(-3) & 1\times (-2) +2\times(-4)\\
	3 \times(-1) + 4\times(-3) & 3\times(-2) +4 \times(-4)
	\end{matrix}
\right]=
\left[
	\begin{matrix}
	-7 & -10\\
	-15& -22
	\end{matrix}
\right]
$$

{{< /math >}}

**é€å…ƒç´ ä¹˜æ³•**å¦‚ä¸‹ğŸ‘‡

{{< math >}}
$$
\textbf{A}\odot\textbf{B} =
\left[
	\begin{matrix}
	1 \times(-1)& 2\times(-2)\\
	3 \times(-3)& 4 \times(-4)
	\end{matrix}
\right]=
\left[
	\begin{matrix}
	-1 & -4\\
	-9& -16
	\end{matrix}
\right]
$$

{{< /math >}}

### b. äº†è§£è¿å¼æ³•åˆ™

å¦‚æœå°†å¤åˆå‡½æ•°f(g(x))å¯¹xæ±‚å¯¼ï¼Œéœ€è¦ä½¿ç”¨é“¾å¼æ³•åˆ™ï¼Œ
$$
\frac{\partial f(g(x))}{\partial x} = \frac{\partial f(g(x))}{\partial g(x)} \frac{\partial g(x)}{\partial x}
$$


ä¸¾ä¸ªæ —å­ï¼Œ
$$
\frac{\partial e^{-x}}{\partial x} = \frac{\partial e^{-x}}{\partial (-x)} \frac{\partial (-x)}{\partial x}=e^{-x}\cdot(-1) = -e^{-x}
$$
è¿™ä¹Ÿæ˜¯ç¥ç»ç½‘ç»œæ ¹æ®ç»“æœæ¥æ›´æ–°å‰é¢nå±‚å‚æ•°çš„åŸºç¡€ã€‚

### c.äº†è§£ç¥ç»ç½‘ç»œ

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œğŸ‘‡

![Sample_Neural_Network](Sample_Neural_Network.png)

å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªç¥ç»ç½‘ç»œçš„éšè—å±‚ï¼ˆé™¤äº†ç¬¬ä¸€å±‚è¾“å…¥å±‚å’Œæœ€åä¸€å±‚è¾“å‡ºå±‚ä¹‹å¤–éƒ½æ˜¯éšè—å±‚ï¼‰ä¸æ‰€æœ‰ä¸Šä¸€å±‚çš„ç¥ç»å…ƒéƒ½è¿æ¥äº†ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°è¿™æ ·çš„å±‚ä¸ºå…¨è¿æ¥å±‚ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå›¾ä¸­çš„ç¥ç»ç½‘ç»œè¾ƒä¸ºå¤æ‚ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯¹ç½‘ç»œè¿›è¡Œæ‹†è§£è‡³æœ€å°å•å…ƒã€‚

å…ˆçœ‹çœ‹æœ€åŸºæœ¬çš„**ç¥ç»å…ƒ**æ˜¯å¦‚ä½•è¿›è¡Œå†…éƒ¨è®¡ç®—çš„ã€‚ğŸ‘‡

![image-20220320161409471](image-20220320161409471.png)

******

å¯ä»¥çœ‹åˆ°ï¼Œå…¶å®ä¸éš¾ï¼Œæ¯ä¸ªç¥ç»å…ƒæ¥å—åˆ°æ¥è‡ªä¸Šä¸€å±‚çš„æ¯ä¸€ä¸ªè¾“å…¥ï¼ˆå³ä¸Šä¸€å±‚éœ€è¦è¿æ¥çš„è¾“å‡ºä¹˜ä»¥ï¼ˆä¸Šä¸€å±‚è‡³å½“å‰å±‚çš„æƒé‡çŸ©é˜µï¼‰å¾—åˆ°çš„$w_{j_i}^{[l]}$ï¼‰å€¼ï¼Œå¹¶å°†è¿™äº›å€¼æ±‚å’Œï¼Œç„¶ååŠ ä¸Šæœ¬ç¥ç»å…ƒçš„Biasï¼Œç»è¿‡æ¿€æ´»å‡½æ•°$\sigma$å¾—åˆ°æ­¤ç¥ç»å…ƒçš„è¾“å‡º $a_j^{[l]}$ã€‚

ç„¶åæˆ‘ä»¬è®©ç¥ç»å…ƒå›å½’åˆ°ç¥ç»ç½‘ç»œä¸­ï¼Œçœ‹ä¸€ä¸‹æ•´ä¸ªç½‘ç»œçš„å‰é¦ˆè®¡ç®—è„‰è·¯ğŸ‘‡

![image-20220320162715911](image-20220320162715911.png)

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè¿™å°±æ˜¯ä¸€ä¸ªåŸºæœ¬çš„å‰é¦ˆç¥ç»ç½‘ç»œè®¡ç®—è¿‡ç¨‹ã€‚å…¶ä¸­ï¼Œ$Z$ä»£è¡¨çš„æ˜¯æœ¬ç¥ç»å…ƒçš„æ¿€æ´»å‡½æ•°æ‰€æ¥å—çš„è¾“å…¥å€¼ï¼Œä¹Ÿå°±æ˜¯æœ¬ç¥ç»å…ƒæ¥å—çš„æ¥è‡ªä¸Šä¸€å±‚å„ç¥ç»å…ƒçš„è¾“å‡ºï¼ˆå¦‚æœä¸æ˜¯å…¨è¿æ¥å±‚ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸Šä¸€å±‚éƒ¨åˆ†ç¥ç»å…ƒçš„è¾“å‡ºï¼‰ä¹˜ä»¥æƒé‡wï¼Œæ±‚å’Œåï¼ŒåŠ ä¸Šæœ¬ç¥ç»å…ƒçš„Biaså¾—åˆ°çš„å€¼ã€‚

å¦‚æœå¯¹è¿™ä¸ªè¿‡ç¨‹ä¸æ˜¯ç‰¹åˆ«äº†è§£ï¼Œé‚£æˆ‘ä»¬ä»¥çŸ©é˜µçš„å½¢å¼å†™ä¸€æ¬¡$Z$çš„è®¡ç®—èŒƒä¾‹ã€‚ğŸ‘‡

å¯¹éƒ¨åˆ†å‚æ•°è¿›è¡Œå¦‚ä¸‹å®šä¹‰ğŸ‘‡
$$
\begin{array}{cc}
w^{[1]}=\left[\begin{array}{ll}
w_{11}^{[1]} & w_{12}^{[1]} \\
w_{21}^{[1]} & w_{22}^{[1]} \\
w_{31}^{[1]} & w_{32}^{[1]}
\end{array}\right] & w^{[2]}=\left[\begin{array}{lll}
w_{11}^{[2]} & w_{12}^{[2]} & w_{13}^{[2]} \\
w_{21}^{[2]} & w_{22}^{[2]} & w_{23}^{[2]}
\end{array}\right] \\
b^{[1]}=\left[\begin{array}{c}
b_{1}^{[1]} \\
b_{2}^{[1]} \\
b_{3}^{[1]}
\end{array}\right] & b^{[2]}=\left[\begin{array}{c}
b_{1}^{[2]} \\
b_{2}^{[2]}
\end{array}\right]
\end{array}
$$
äºæ˜¯ï¼Œå›¾ä¸­ä¸¤ä¸ªéšè—å±‚$Z$çš„è®¡ç®—å¦‚ä¸‹ğŸ‘‡

$$
\begin{array}{c}
z^{[1]}=\left[\begin{array}{ll}
w_{11}^{[1]} & w_{12}^{[1]} \\
w_{21}^{[1]} & w_{22}^{[1]} \\
w_{31}^{[1]} & w_{32}^{[1]}
\end{array}\right] \cdot\left[\begin{array}{c}
a_{1}^{[0]} \\
a_{2}^{[0]}
\end{array}\right]+\left[\begin{array}{c}
b_{1}^{[1]} \\
b_{2}^{[1]} \\
b_{3}^{[1]}
\end{array}\right]=\left[\begin{array}{c}
w_{11}^{[1]} a_{1}^{[0]}+w_{12}^{[1]} a_{2}^{[0]}+b_{1}^{[1]} \\
w_{21}^{[1]} a_{1}^{[0]}+w_{22}^{[1]} a_{2}^{[0]}+b_{2}^{[1]} \\
w_{31}^{[1]} a_{1}^{[0]}+w_{32}^{[1]} a_{2}^{[0]}+b_{3}^{[1]}
\end{array}\right] \\
z^{[2]}=\left[\begin{array}{lll}
w_{11}^{[2]} & w_{12}^{[2]} & w_{13}^{[2]} \\
w_{21}^{[2]} & w_{22}^{[2]} & w_{23}^{[2]}
\end{array}\right] \cdot\left[\begin{array}{c}
a_{1}^{[1]} \\
a_{2}^{[1]} \\
a_{3}^{[1]}
\end{array}\right]+\left[\begin{array}{l}
b_{1}^{[2]} \\
b_{2}^{[2]}
\end{array}\right]=\left[\begin{array}{l}
w_{11}^{[2]} a_{1}^{[1]}+w_{12}^{[2]} a_{2}^{[1]}+w_{13}^{[2]} a_{3}^{[1]}+b_{1}^{[2]} \\
w_{21}^{[2]} a_{1}^{[1]}+w_{22}^{[2]} a_{2}^{[1]}+w_{23}^{[2]} a_{3}^{[1]}+b_{2}^{[2]}
\end{array}\right] \\
\end{array}
$$


å¯ä»¥è¡¨è¿°æˆğŸ‘‡
$$
\textbf{Z}^{[l]}=w^{[l]}\cdot \textbf{A}^{[l-1]} +b^{[l]}
$$
é‚£ä¹ˆï¼Œæœ€åä¸€å±‚çš„è¾“å‡ºå‘¢å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„é¢„æµ‹å€¼ï¼Œå¯¹äºè¿™ä¸€ä¸ªé¢„æµ‹å€¼ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒä¸çœŸå®å€¼ä¸è¦æœ‰è¿‡å¤§çš„åå·®ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬ä¾¿éœ€è¦ä¸€ä¸ªåº¦é‡æ–¹æ³•æ¥è¡¡é‡é¢„æµ‹å€¼ä¸ç›®æ ‡å€¼çš„åå·®ç¨‹åº¦ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªç¨‹åº¦é‡åŒ–ä¸ºæŸå¤±å‡½æ•°çš„å‡½æ•°å€¼Lossï¼Œé‚£ä¹ˆè¿™ä¸ªæŸå¤±å‡½æ•°å¦‚ä½•å»å®šä¹‰å‘¢ï¼Ÿè¿™å°±ç‰µæ‰¯åˆ°ä½ æ‰€éœ€è¦çš„é¢„æµ‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œå®ƒä¸å®é™…å€¼çš„å…³ç³»æ˜¯æ€æ ·çš„äº†ï¼Œä»¥åæœ‰æœºä¼šå‡ºä¸€ç¯‡æ–‡ç« æ¢³ç†ä¸€äº›å¸¸ç”¨çš„æŸå¤±å‡½æ•°ã€‚ç°åœ¨æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæœ€ç®€å•çš„åº¦é‡æ–¹æ³•ï¼Œä¹Ÿæˆä¸º$L_1$åº¦é‡ï¼Œå³ç»å¯¹å·®å€¼åº¦é‡æ³•ï¼Œå®šä¹‰$(\hat{y},y)$ä¸ºï¼ˆç½‘ç»œé¢„æµ‹å€¼ï¼ŒçœŸå®å€¼ï¼‰ï¼Œé‚£ä¹ˆå‡½æ•°$L(\hat{y},y)$å¯ä»¥å®šä¹‰å¦‚ä¸‹ğŸ‘‡
$$
L(\hat{y},y)=|\hat{y}-y|
$$
é‚£ä¹ˆï¼Œä»–è¾“å‡ºçš„å‡½æ•°å€¼å°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„åå·®åº¦é‡ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œç¥ç»ç½‘ç»œéœ€è¦è¿›è¡Œå­¦ä¹ ï¼Œå­¦ä¹ çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå…¶å®å°±æ˜¯ä¸€ä¸ªåˆ†å¸ƒï¼Œå¸Œæœ›åœ¨ç»™å‡ºæ¡ä»¶$x$ä¸‹ï¼Œèƒ½å¤Ÿç»™å‡ºç›¸åº”çš„æ˜ å°„$y$ï¼Œå³ç½‘ç»œèƒ½å¤Ÿé€šè¿‡æ˜ å°„è®¡ç®—å»æ‹Ÿåˆæ•°æ®ä¸­çš„åˆ†å¸ƒ$p(x)$ã€‚è¿™ä¸ªæ‹Ÿåˆè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯ç¼©å°åå·®åº¦é‡ï¼Œé‚£ä¹ˆå¦‚ä½•ç¼©å°åå·®å‘¢ï¼Ÿè¿™æ—¶ä¾¿å‡ºç°äº†æˆ‘ä»¬çš„ä¸»è§’ï¼Œåå‘ä¼ æ’­ç®—æ³•ï¼Œè¿™æ˜¯ä¸€ä¸ªé€šè¿‡è¾“å‡ºæ¥åé¦ˆä¿¡æ¯çš„ç®—æ³•ï¼Œä¹Ÿæ˜¯ç¥ç»ç½‘ç»œå­¦ä¹ çš„æ ¹æœ¬æ‰€åœ¨ï¼Œå®ƒçš„å…¨åå…¶å®æ˜¯è¯¯å·®åå‘ä¼ æ’­ï¼Œå³é€šè¿‡è¯¯å·®å›ä¼ ï¼Œè®©æ¨¡å‹çš„å‚æ•°å…±åŒè°ƒæ•´å»å‡å°è¿™ä¸ªè¯¯å·®ã€‚

é‚£ä¹ˆè¯¯å·®æˆ‘ä»¬ç†Ÿæ‚‰ï¼Œå°±æ˜¯ä¸¤ä¸ªå€¼ä¹‹é—´çš„å·®å€¼ï¼Œè€Œå½“æˆ‘ä»¬å°†è¿™ä¸ªå·®å€¼è§†ä¸ºå‡½æ•°å·®å€¼çš„æ—¶å€™ï¼Œä»–å°±å¯ä»¥ä¸å‡½æ•°æ±‚å¯¼æŒ‚é’©ï¼Œå›é¡¾ä¸€ä¸‹æ±‚å¯¼æ³•åˆ™ğŸ‘‡
$$
f'(x)=\lim_{\Delta x \rightarrow0} \frac{\Delta y}{\Delta x}
$$
å¯ä»¥çœ‹åˆ°ï¼Œé€šä¿—çš„è¯´ï¼Œæœ‰äº†å¯¼æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“è¦å°†åå·®å¤šå°‘$y$è°ƒæ•´å›æ¥ï¼Œéœ€è¦å¤šå°‘çš„$x$ã€‚

é‚£ä¹ˆé—®é¢˜åˆæ¥äº†ï¼Œå¯¹äºé‚£ä¹ˆå¤šçš„ç½‘ç»œå‚æ•°ï¼Œæˆ‘ä»¬æ€ä¹ˆå»è°ƒæ•´å‘¢ï¼Ÿ

$$
\begin{array}{cc}
w^{[1]}=\left[\begin{array}{ll}
w_{11}^{[1]} & w_{12}^{[1]} \\
w_{21}^{[1]} & w_{22}^{[1]} \\
w_{31}^{[1]} & w_{32}^{[1]}
\end{array}\right] \quad w^{[2]}=\left[\begin{array}{lll}
w_{11}^{[2]} & w_{12}^{[2]} & w_{13}^{[2]} \\
w_{21}^{[2]} & w_{22}^{[2]} & w_{23}^{[2]}
\end{array}\right] \\
b^{[1]}=\left[\begin{array}{c}
b_{1}^{[1]} \\
b_{2}^{[1]} \\
b_{3}^{[1]}
\end{array}\right] & b^{[2]}=\left[\begin{array}{c}
b_{1}^{[2]} \\
b_{2}^{[2]}
\end{array}\right]
\end{array}
$$


ç­”æ¡ˆå°±æ˜¯ï¼Œåå¯¼æ•°ğŸ‘‡


$$
f_x'(x,y)=\frac{\partial f}{\partial x}
$$
åå¯¼æ•°æ˜¯å•¥ï¼Œåå¯¼æ•°å°±æ˜¯æœ‰åè§çš„å¯¼æ•°ï¼Œåªå¯¹ç‰¹å®šçš„æ¡ä»¶$x$æ„Ÿå…´è¶£ï¼Œä¹Ÿå°±æ˜¯åå¯¼çš„ä¸€æ–¹ï¼Œè€Œå…¶ä»–çš„è§†ä¸ºå¸¸æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½ç²¾å‡†åœ°å¯¹ä¸åŒå‚æ•°è¿›è¡Œæ›´æ–°ã€‚

ä¸¾ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼Œè®¾ğŸ‘‡
$$
f(x,y)=xy
$$
é‚£ä¹ˆå¦‚æœå¯¹$x$åå¯¼ğŸ‘‡
$$
f_x(x,y)=y
$$
åä¹‹ï¼Œè‹¥å¯¹$y$åå¯¼ğŸ‘‡
$$
f_y(x,y)=x
$$
é‚£ä¹ˆï¼Œåœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œåå¯¼çš„æ¦‚å¿µå°±è§†ä¸ºäº†æ¢¯åº¦$\nabla$ï¼Œä¸ºå•¥å«æ¢¯åº¦å‘¢ï¼Ÿæ¢¯åº¦$\nabla$çš„æœ¬æ„æ˜¯ä¸€ä¸ªå‘é‡ï¼ˆçŸ¢é‡ï¼‰ï¼Œè¡¨ç¤ºæŸä¸€å‡½æ•°åœ¨è¯¥ç‚¹å¤„çš„æ–¹å‘å¯¼æ•°æ²¿ç€è¯¥æ–¹å‘å–å¾—æœ€å¤§å€¼ï¼Œé‚£ä¹ˆå¦‚æœåœ¨æŸä¸€ä¸ªå˜é‡ä¸Šéœ€è¦å¯¹è¯¯å·®äº§ç”Ÿæœ€å¤§çš„å½±å“ï¼Œåˆ™éœ€è¦æ²¿ç€æ¢¯åº¦$\nabla$çš„æ–¹å‘ï¼Œä¹Ÿå°±æ˜¯åå¯¼çš„æ–¹å‘ã€‚

![image-20220320191435200](image-20220320191435200.png)
$$
w:=w-a \frac{\partial J(w)}{\partial w}
$$
å›¾ä¸­æ˜¯ç›®æ ‡å‡½æ•°å¯¹å˜é‡$w$çš„æ¢¯åº¦$\nabla$ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæ¢¯åº¦$\nabla$åœ¨å›¾çº¿ä¸Šè¡¨ç°ä¸ºåˆ‡çº¿ï¼Œå¾ˆå®¹æ˜“çŸ¥é“åœ¨è¿™ä¸ªæ–¹å‘ä¸Šèƒ½å¤Ÿå¯¹ç›®æ ‡å‡½æ•°çš„å€¼å¸¦æ¥æœ€å¤§çš„å½±å“ï¼Œé‚£ä¹ˆå˜é‡$w$åœ¨å½“å‰æ—¶åˆ»æ²¿ç€è¿™ä¸ªæ–¹å‘å˜åŒ–ä¾¿èƒ½ä¸ºç¼©å°è¯¯å·®åšå‡ºæœ€å¤§è´¡çŒ®ã€‚

å¦‚æœæ‹“å±•åˆ°çŸ©é˜µåˆ™å®¹æ˜“å¾—åˆ°çŸ©é˜µæ¢¯åº¦$\nabla$çŸ©é˜µï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå…ƒç´ çš„æ¢¯åº¦å•¦ã€‚ğŸ‘‡

{{< math >}}
$$
\nabla_{\textbf{A}}f(\textbf{A})=
\begin{bmatrix}
\frac{\partial f(A)}{\partial A_{11}} & \frac{\partial f(A)}{\partial A_{12}} & \cdots & \frac{\partial f(A)}{\partial A_{13}} \\
\frac{\partial f(A)}{\partial A_{21}} & \frac{\partial f(A)}{\partial A_{12}} & \cdots & \frac{\partial f(A)}{\partial A_{23}} \\
\vdots & \vdots & \ddots & \vdots \\
\frac{\partial f(A)}{\partial A_{m1}} & \frac{\partial f(A)}{\partial A_{m2}} & \cdots & \frac{\partial f(A)}{\partial A_{m3}} \\
\end{bmatrix}
$$

$$
(\nabla_{\textbf{A}}f(\textbf{A}))_{ij}=\frac{\textbf A}{\partial A_{ij}}
$$

{{< /math >}}

## è¯¯å·®åå‘ä¼ æ’­

ä¸ºè¯¯å·®å¯¹ç¥ç»å…ƒè¾“å…¥çš„å€¼ï¼ˆæ¿€æ´»å‰ï¼‰$z$    åšå¦‚ä¸‹å‡è®¾ğŸ‘‡

<img src="image-20220320194036816.png" alt="image-20220320194036816" style="zoom:35%;" />

![image-20220320194658134](image-20220320194658134.png)

é‚£ä¹ˆå¯¹äºè¾“å‡ºå±‚ğŸ‘‡

$$
\delta_{j}^{[L]}=\frac{\partial L}{\partial a_{j}^{[L]}} \sigma^{\prime}\left(z_{j}^{[L]}\right) \quad \delta^{[L]}=\left[\begin{array}{c}
\frac{\partial L}{\partial a_{1}^{L L}} \\
\frac{\partial L}{\partial a_{2}^{[L]}} \\
\vdots \\
\frac{\partial L}{\partial a_{j}^{L L}}
\end{array}\right] \odot\left[\begin{array}{c}
\sigma^{\prime}\left(z_{1}^{[L]}\right) \\
\sigma^{\prime}\left(z_{2}^{[L]}\right) \\
\vdots \\
\sigma^{\prime}\left(z_{j}^{[L]}\right)
\end{array}\right] \quad \delta^{[L]}=\nabla_{a} L \odot \sigma^{\prime}\left(z^{[L]}\right)
$$


å¯¹äºéšè—å±‚ğŸ‘‡
$$
\delta_{j}^{[l]}=\sum_{k} w_{k j}^{[l+1]} \delta_{k}^{[l+1]} \sigma^{\prime}\left(z_{j}^{[l]}\right)
\\
\delta^{[l]}=\left[\left[\begin{array}{cccc}
w_{11}^{[l]} & w_{12}^{[l]} & \ldots & w_{1 k}^{[l]} \\
w_{21}^{[l]} & w_{22}^{[l]} & \ldots & w_{2 k}^{[l]} \\
\vdots & \vdots & \ddots & \vdots \\
w_{j 1}^{[l]} & w_{j 2}^{[l]} & \ldots & w_{j k}^{[l]}
\end{array}\right]\left[\begin{array}{c}
\delta_{1}^{[l+1]} \\
\delta_{2}^{[l+1]} \\
\vdots \\
\delta_{k}^{[l+1]}
\end{array}\right]\right] \odot\left[\begin{array}{c}
\sigma^{\prime}\left(z_{1}^{[l]}\right) \\
\sigma^{\prime}\left(z_{2}^{[l]}\right) \\
\vdots \\
\sigma^{\prime}\left(z_{j}^{[l]}\right)
\end{array}\right]
\\
(\mathrm{j}, \mathrm{k}) *(\mathrm{k}, 1) \odot(\mathrm{j}, 1)=(\mathrm{j}, 1)
\\
\delta^{[l]}=\left[w^{[l+1]^{T}} \delta^{[l+1]}\right] \odot \sigma^{\prime}\left(z^{[l]}\right)
$$
æ›´æ–°æ­¥ğŸ‘‡
$$
\begin{array}{c}
\frac{\partial L}{\partial b_{j}^{[l]}}=\delta_{j}^{[l]} \\
\frac{\partial L}{\partial w_{j k}^{[l]}}=a_{k}^{[l-1]} \delta_{j}^{[l]} \\
\frac{\partial L}{\partial b^{[l]}}=\left[\begin{array}{c}
\delta_{1}^{[l]} \\
\delta_{2}^{[l]} \\
\vdots \\
\delta_{j}^{[l]}
\end{array}\right]=\delta^{[l]}
\\
\frac{\partial L}{\partial w^{[l]}}=\left[\begin{array}{c}
\delta_{1}^{[l]} \\
\delta_{2}^{[l]} \\
\vdots \\
\delta_{j}^{[l]}
\end{array}\right]\left[\begin{array}{lll}
a_{1}^{[l]} & a_{2}^{[l]} \ldots & a_{k}^{[l]}
\end{array}\right]\\
(j, 1) *(1, k)=(j, k)\\
\frac{\partial L}{\partial b^{[l]}}=\delta^{[l]}\\
\frac{\partial L}{\partial w^{[l]}}=\delta^{[l]} a^{[l-1] T}

\end{array}
$$

$$
\begin{aligned}
b_{j}^{[l]} & \leftarrow b_{j}^{[l]}-\alpha \frac{\partial L}{\partial b_{j}^{l]}} \\
w_{j k}^{[l]} & \leftarrow w_{j k}^{[l]}-\alpha \frac{\partial L}{\partial w_{j k}^{[l]}} \\
b^{[l]} & \leftarrow b^{[l]}-\alpha \frac{\partial L}{\partial b^{[l]}} \\
w^{[l]} & \leftarrow w^{[l]}-\alpha \frac{\partial L}{\partial w^{[l]}}
\end{aligned}
$$

å›¾è§£åå‘ä¼ æ’­è¿‡ç¨‹ï¼Œé¦–å…ˆæ˜¯è¾“å‡ºå±‚ğŸ‘‡

![image-20220320194450466](image-20220320194450466.png)

è¯¯å·®æ¢¯åº¦ä¼ å‘ç¬¬ä¸€ä¸ªéšè—å±‚ğŸ‘‡

![image-20220320194504910](image-20220320194504910.png)

ğŸ‘‡

![image-20220320194514080](image-20220320194514080.png)

ğŸ‘‡

![image-20220320194525268](image-20220320194525268.png)

ğŸ‘‡

![image-20220320194540030](image-20220320194540030.png)

ğŸ‘‡

![image-20220320194552307](image-20220320194552307.png)

ğŸ‘‡

![image-20220320194609869](image-20220320194609869.png)

ä»¥æ­¤ç±»æ¨ï¼Œåå‘ä¼ æ’­çš„è¿‡ç¨‹å°±ç»“æŸå•¦~





