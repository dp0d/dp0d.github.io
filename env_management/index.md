# Python å·¥ç¨‹ç¯å¢ƒç®¡ç†


# å‰è¨€

åœ¨Pythonå·¥ç¨‹ä¸­ï¼Œç‰¹åˆ«æ˜¯å¯¹äºè¦å¤ç°ä¸€äº›é¡¹ç›®æ—¶ã€éœ€è¦æµ‹è¯•ç‰¹å®šç¯å¢ƒä¸‹ç¨‹åºè¡¨ç°æ—¶ã€åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Šå¤šäººè¿›è¡Œè·‘ç¨‹åºæ—¶éœ€è¦è‡ªå·±çš„ç‹¬ç«‹ç¯å¢ƒæ—¶ç­‰ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ç”¨åˆ°ç‰¹å®šç‰ˆæœ¬çš„åº“ï¼Œè€Œè¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒå®‰è£…ä¾èµ–ã€‚è¿™æ ·ä¾èµ–ï¼Œæˆ‘ä»¬å°±ä¸ä¼šå½±å“åˆ°ä¸»ç¯å¢ƒï¼Œè¯¶è¿™æ ·å°±

- ä¸ç”¨é‡å¤å¸è½½é‡è£…ä¸»ç¯å¢ƒï¼Œ
- ä¹Ÿä¸ä¼šä½¿å¾—ä¸»ç¯å¢ƒæ—¥æ¸è‡ƒè‚¿ï¼›
- è¿˜å¯ä»¥å®‰è£…å¤šç‰ˆæœ¬pythonï¼ˆå¦‚ç»å…¸çš„pyenv åŒ…ç®¡ç†è½¯ä»¶ä¾¿å¯ä»¥å®ç°ï¼‰ï¼›
- å¦‚æœ‰éœ€è¦ç›´æ¥åˆ æ‰è™šæ‹Ÿç¯å¢ƒï¼Œç„¶åå»ºæ–°çš„å³å¯ã€‚

ç”±äºç³»ç»Ÿé…ç½®çš„ä¸ç¡®å®šæ€§ï¼Œå»ºè®®å‹å‹ä»¬åœ¨linuxä¸‹é£Ÿç”¨ã€‚

# ç¯å¢ƒç®¡ç†é€”å¾„ä»‹ç»

ç¯å¢ƒéœ€è¦ç”¨åˆ°çš„åŒ…å¯ä»¥å†™å…¥requirements.txtæ–‡ä»¶é‡Œï¼Œå¦‚æœæ˜¯ä»å¦ä¸€ä¸ªå·¥ç¨‹ç¯å¢ƒåˆ‡æ¢è¿‡æ¥ï¼Œå¯ä»¥åœ¨é‚£ä¸ªç¯å¢ƒä¸­è¿è¡Œ

```python
pip freeze > requirements.txt
```

ç„¶ååœ¨éœ€è¦é…ç½®çš„ç¯å¢ƒä¸­è¿è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…å¤§éƒ¨åˆ†éœ€è¦çš„åŒ…

```bash
cat requirements.txt | xargs -n 1 pip install
```

æ­¤æ–¹æ³•ä¼šå¿½ç•¥æŠ¥é”™è¿›è¡ŒpipåŒ…çš„å®‰è£…ï¼Œä¼šå‡ºç°åŒ…çš„ç¼ºæŸï¼Œåç»­å¯ä»¥è‡ªè¡Œè¡¥ä¸Šã€‚

é•œåƒæº

```bash
pip -i https://pypi.tuna.tsinghua.edu.cn/simple

è±†ç“£ï¼š-i http://pypi.douban.com/simple/  --trusted-host pypi.douban.com

é˜¿é‡Œäº‘ï¼š-i http://mirrors.aliyun.com/pypi/simple/ --trusted-host mirrors.aliyun.com

# è®¾ç½®å…¨å±€
# æ¸…åæº
pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
```



## Conda

+ æŸ¥çœ‹æˆ‘ä»¬å½“å‰condaé‡Œæœ‰çš„ç¯å¢ƒ ï¼Œä¸‰ç§æ–¹å¼éƒ½å¯ğŸ‘‡ğŸ»

```bash
conda info --envs

conda info -e

conda env list
```

è¾“å‡ºå¦‚ä¸‹ğŸ‘‡ğŸ»

<img src="20210716190224507.png" alt="image-20220322093653365" style="zoom: 110%;" />


+ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ç›®å‰åªæœ‰ä¸€ä¸ªbaseçš„åŸºç¡€ç¯å¢ƒã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¯•ç€æŸ¥çœ‹ä¸€ä¸‹è¯¥ç¯å¢ƒä¸‹çš„åŒ…åˆ—è¡¨ğŸ‘‡ğŸ»

<img src="image-20220322093653365.png" alt="image-20220322093653365" style="zoom: 33%;" />

### Condaåˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

åˆ›å»ºæ—¶æŒ‡å®š condaä¸‹çš„è™šæ‹Ÿç¯å¢ƒåå­—ä¸ºenv_nameï¼Œpythonç‰ˆæœ¬ä¸º3.6ğŸ‘‡

```bash
conda create -n env_name python=3.6
```

æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡ymlæ–‡ä»¶æ¥æ„å»ºè‡ªå·±æƒ³è¦çš„ç¯å¢ƒï¼Œæ¯”å¦‚ä½ æƒ³è¦å¦‚ä¸‹é…ç½®çš„ç¯å¢ƒï¼ˆnameæŒ‡çš„æ˜¯ä½ çš„è™šæ‹Ÿç¯å¢ƒå«å•¥ï¼Œä¸ä¸Šæ¡å‘½ä»¤ä¸­çš„env_nameæ•ˆæœä¸€æ ·ï¼‰ğŸ‘‡

<img src="image-20220322100716436.png" alt="image-20220322100716436" style="zoom:50%;" />

é‚£ä¹ˆï¼Œä½ åˆ™éœ€è¦åœ¨å½“å‰ç›®å½•åˆ›å»ºä¸€ä¸ªymlåç¼€çš„æ–‡ä»¶ï¼Œç„¶åå†™å…¥ä¸Šå›¾ç±»ä¼¼çš„ä½ éœ€è¦çš„ç¯å¢ƒå†…å®¹ï¼Œå¹¶è¿è¡Œå¦‚ä¸‹å‘½ä»¤ğŸ‘‡

```bash
conda env create -f conda_env.yml
```

**å†æ¬¡æŸ¥çœ‹condaä¸‹çš„ç¯å¢ƒåˆ—è¡¨**

![img](20210716191649552.png)

å¯ä»¥çœ‹åˆ°åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„env_nameç¯å¢ƒã€‚

### Condaæ¿€æ´»è™šæ‹Ÿç¯å¢ƒ

è¾“å…¥activateæŒ‡ä»¤ğŸ‘‡

```bash
conda activate env_name
```

å¯ä»¥çœ‹åˆ°

![img](20210716193134100.png)

å‘½ä»¤è¡Œå‰çš„æ‹¬å·å†…å®¹å·²ç»æ”¹å˜(base)ğŸ‘‰(env_name)ï¼Œæ­¤æ—¶å·²ç»æ˜¯åŸºäºè¯¥è™šæ‹Ÿç¯å¢ƒäº†ã€‚

ç„¶åå‘¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥è¿™ä¸ªç¯å¢ƒä¹±è£…ä¸€é€šäº†ï¼Œæ­¤å¤„çœç•¥ä¸€ä¸‡è¡Œæ“ä½œâ€¦â€¦



å¥½äº†ï¼Œè¿™ä¸ªç¯å¢ƒçš„ä½¿å‘½å·²ç»ç»“æŸäº†ï¼Œæˆ‘ä»¬å†æŠŠå®ƒåˆ æ‰ğŸ‘‡

```bash
conda deactivate

conda remove -n env_name --all
```





## Python Virtualenv

è¿™æ˜¯ä¸€æ¬¾pythonè‡ªå¸¦çš„è™šæ‹Ÿç¯å¢ƒç®¡ç†æ–¹æ¡ˆï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸ºå•¥ä¸ç”¨condaå‘¢ï¼Ÿcondaå¤šå¥½ï¼Œè‡ªå¸¦åŒ…åˆå¤šï¼Œå¤šçœäº‹ã€‚é—®é¢˜å°±æ˜¯ï¼Œæœ‰äº›æƒ…å†µä¸‹æˆ‘ä»¬ä¸éœ€è¦ä»»ä½•ä¸€ä¸ªå¤šä½™çš„åŒ…ï¼Œåœ¨å·¥ç¨‹ä¸Šå³ä¾¿æ˜¯å¤šä½™ä¸€ä¸ªåŒ…ä¹Ÿæ˜¯å¯¹å­˜å‚¨ç©ºé—´çš„æµªè´¹ï¼Œcondaå†…éƒ¨æˆ‘ä¸æ˜¯å¾ˆæ¸…æ¥šè¿˜å°è£…äº†ä»€ä¹ˆï¼Œä½†æ€»æ˜¯ç»™äººä¸€ç§å¾ˆå¥å£®çš„æ„Ÿè§‰ï¼Œæ€•éº»çƒ¦çš„è¯æ¨ècondaï¼Œä½†æ˜¯æœ‰æ´ç™–çš„äººæ¨èè‡ªå·±é€æ­¥æ­å»ºç›¸å…³ä¾èµ–ã€‚ç°åœ¨ä»‹ç»çš„è¿™æ¬¾å°±æ˜¯å®˜æ–¹ç»™çš„ï¼Œè¯¶ï¼Œå¹²å‡€ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ éœ€è¦åœ¨å¤šä¸ªpythonç‰ˆæœ¬ä¸Šå»ºç«‹è™šæ‹Ÿç¯å¢ƒï¼Œé‚£ä¹ˆæ¯”è¾ƒéº»çƒ¦ï¼Œä¸‹èŠ‚ä¼šè¯´ï¼Œå»ºè®®ç›´æ¥ç§»æ­¥ä¸‹ä¸€èŠ‚çš„pyenvã€‚ï¼ˆ[Python Virtualenvå®˜æ–¹æ–‡æ¡£#](https://virtualenv.pypa.io/en/latest/index.html)ï¼‰

**æ­¤æ–¹æ¡ˆä¸­è™šæ‹Ÿç¯å¢ƒçš„åˆ›å»ºæ–¹å¼å’Œcondaå·®ä¸å¤šï¼Œè¿™é‡Œä»‹ç»æŒ‡å®šç¯å¢ƒè·¯å¾„çš„æ–¹æ³•ï¼Œå…¶ä¸­env_pathä¸ºä½ è¦ä¿å­˜è¯¥è™šæ‹Ÿç¯å¢ƒçš„è·¯å¾„**

```bash
python -m venv env_path
```

ç„¶åå¯ä»¥æ¿€æ´»æ­¤ç¯å¢ƒ

```bas
source env_path/bin/activate
```

å…³é—­ç¯å¢ƒ

```ba
deactivate
```





## Pyenv

>æ¨èé£Ÿç”¨

Pyenvæ˜¯ä¸€ä¸ªå¼€æºçš„pythonç¯å¢ƒç®¡ç†è½¯ä»¶ï¼ˆ[æºç é“¾æ¥](https://github.com/pyenv/pyenv)ï¼‰ï¼Œå®ƒååˆ†æ–¹ä¾¿å¯ä»¥å®ç°æˆ‘æ‰€è¯´çš„è™šä¸ŠåŠ è™šã€‚è¯¶ï¼Ÿå•¥æ„æ€å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬æŠŠåˆ›å»ºè™šæ‹Ÿç¯å¢ƒçš„**ç¯å¢ƒ**ç§°ä¸º**åº•åº§**ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œæœ¬åœ°ç¯å¢ƒé€šå¸¸åªèƒ½æ»¡è¶³ä¸€ä¸¤ä¸ªpythonç‰ˆæœ¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚çš„Python Virtualenvç¯å¢ƒç®¡ç†æ–¹æ¡ˆå°±åªæœ‰ä¸€ä¸¤ä¸ªåº•åº§ï¼Œå®ƒå°±æ˜¯æœ¬æœºå·²ç»å®‰è£…çš„pythonç‰ˆæœ¬ï¼Œå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥å°†å¤šä¸ªä¸åŒç‰ˆæœ¬çš„pythonè£…åˆ°ä¸åŒçš„æ–‡ä»¶ï¼Œç„¶ååŠ ä¸åŒçš„å¯åŠ¨å‘½ä»¤æ¯”å¦‚python2.xå’Œpython3.xæ¥ä½¿ç”¨ï¼Œä½†è¿™å¹¶ä¸å¥½ç®¡ç†ï¼Œä¸”è¾ƒä¸ºéº»çƒ¦ã€‚è€Œä¸”ï¼Œå°±åƒä¹‹å‰è¯´çš„ï¼Œä¼šä½¿å¾—å¯¹äºæœ‰æ´ç™–çš„å‹å‹å¾ˆä¸å¥½å—ï¼Œä¸èƒ½ä¸€æ½å…¨å±€ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Pyenvï¼Œåˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œå› ä¸ºå®ƒå¯ä»¥ç”¨æ¥å®‰è£…ä¸åŒç‰ˆæœ¬çš„pythonï¼Œcondaï¼Œminicondaç­‰ï¼Œå†™åˆ°è¿™é‡Œåšä¸»å¿½ç„¶è§‰å¾—Pyenvå¥½åƒå°±æ˜¯åœ¨å¥—å£³ä¸Šè¿°ä¸¤ç§æ–¹æ³•ï¼Œä½†æ˜¯ä¾¿æ·æ€§æå‡å¾ˆå¤šï¼Œæ•…æˆ‘ä»¬å°±ç›¸å½“äºåˆ›å»ºäº†ä¸åŒçš„åº•åº§ï¼Œä½¿ç”¨Pyenvæ¥ç»Ÿä¸€ç®¡ç†ğŸ‘‡

![Pyenv](Pyenv.png)





### å®‰è£…

> LinuxğŸ‘‡

```bas
curl -L https://github.com/pyenv/pyenv-installer/raw/master/bin/pyenv-installer | bash
```

```bas
echo 'export PATH="$HOME/.pyenv/bin:$PATH"' >> ~/.bashrc
```

ç¦»çº¿éƒ¨ç½²

å…ˆä½¿ç”¨èƒ½å¤Ÿç§‘å­¦ä¸Šç½‘çš„æœºå™¨ä¸‹è½½release  https://github.com/pyenv/pyenv

ç„¶åæ”¾åˆ°éœ€è¦éƒ¨ç½²çš„æœºå™¨ä¸Šä¸Š

```bash
tar -zxvf pyenv-2.3.2.tar.gz

mv pyenv-2.3.2 ~/.pyenv
mkdir ~/.pyenv/cache

cat >> ~/.bashrc<<'EOF'
### pyenv ###
export PYENV_ROOT="$HOME/.pyenv" 
export PATH="$PYENV_ROOT/bin:$PATH"
export PATH="$PYENV_ROOT/shims:$PATH"
eval "$(pyenv init -)"
EOF

source ~/.bashrc

pyenv --version
pyenv 2.2.0
```



> MacOS

```bash
brew update
brew install pyenv
```



> Windows

pyenvå®˜æ–¹æ²¡æœ‰æ”¯æŒwindowsï¼Œæ¨èä½¿ç”¨pyenv-winï¼ˆ[githubåœ°å€](https://github.com/pyenv-win/pyenv-win#installation)ï¼‰

1. **windowsä¸‹æ¨èä½¿ç”¨pipå®‰è£…pyenv-win**

```ba
pip install pyenv-win --target %USERPROFILE%\.pyenv
```

2. æˆ–è€…ä¸‹è½½zipæ–‡ä»¶ç„¶åè§£å‹åˆ°`%USERPROFILE%\.pyenv\pyenv-win`ä¸‹





### é£Ÿç”¨æ–¹æ³•

> æŸ¥çœ‹å¯ä»¥å®‰è£…çš„ç›¸åº”ç‰ˆæœ¬çš„ç¯å¢ƒï¼ˆä¸€èˆ¬åªæœ‰æ•°å­—çš„é€‰é¡¹é»˜è®¤æŒ‡pythonç¯å¢ƒï¼‰

```bash
pyenv install -l
```

> å®‰è£…æ‰€éœ€è¦çš„,å¦‚é€‰æ‹©python3.6.15ç¯å¢ƒ

```bash
pyenv install 3.6.15
```

> å€ŸåŠ©é•œåƒæºå®‰è£…

```bash
v=3.6.15; curl -L https://npm.taobao.org/mirrors/python/$v/Python-$v.tar.xz -o ~/.pyenv/cache/Python-$v.tar.xz; pyenv install $v
```

>æ¿€æ´»æ‰€éœ€è¦çš„ï¼ˆæ­¤å¤„å¯ä»¥ç›´æ¥æ¿€æ´»å‰æ–‡ä¸­äºŒçº§åº•åº§çš„è™šæ‹Ÿç¯å¢ƒï¼‰

```bas
pyenv activate 3.6.15
```

æš‚æ—¶å°†æŸä¸ªç¯å¢ƒåº”ç”¨åˆ°æ‰€æœ‰ç›®å½•çš„å‘½ä»¤è¡Œä¸‹

```bash
pyenv global 3.6.15
```

> è¿›å…¥æŸä¸ªç›®å½•æ—¶ï¼Œå‘½ä»¤è¡Œè‡ªåŠ¨åˆ‡æ¢åˆ°å¯¹åº”ç¯å¢ƒçš„æ–¹æ³•

- åœ¨è¿™ä¸ªç›®å½•æ–°å»ºä¸€ä¸ªåä¸º`.python-version`çš„æ–‡ä»¶
- åœ¨å…¶ä¸­å†™å…¥ä½ å¸Œæœ›æ¿€æ´»çš„ç¯å¢ƒåç§°

> é€€å‡ºç¯å¢ƒ

```bash
pyenv source deactivate
```

> åˆ é™¤ç¯å¢ƒï¼ˆä¸€çº§åº•åº§ï¼‰

```bash
pyenv uninstall 3.6.15
```





#### åŸºäºæŸä¸ªç¯å¢ƒå»ºç«‹è™šæ‹Ÿç¯å¢ƒå¹¶å–`è™šæ‹Ÿç¯å¢ƒå`

1. **å¯ä»¥å…ˆæ¿€æ´»è¿™ä¸ªç¯å¢ƒï¼Œç„¶ååœ¨è¿™ä¸ªç¯å¢ƒä¸‹åˆ›å»ºï¼Œæ¿€æ´»ï¼Œé€€å‡ºï¼Œåˆ é™¤è™šæ‹Ÿç¯å¢ƒ**
2. ä¹Ÿå¯ä»¥ä¸æ¿€æ´»ï¼Œç›´æ¥ä½¿ç”¨pyenvå‘½ä»¤

> åœ¨ä¸€çº§åº•åº§ä¸Šåˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

```bash
pyenv virtualenv 3.6.15 è™šæ‹Ÿç¯å¢ƒå
```

> ç„¶åæ¿€æ´»è™šæ‹Ÿç¯å¢ƒ

```bash
pyenv activate è™šæ‹Ÿç¯å¢ƒå
```

> é€€å‡ºè™šæ‹Ÿç¯å¢ƒ

```bash
pyenv deactivate è™šæ‹Ÿç¯å¢ƒå
```

> åˆ é™¤è™šæ‹Ÿç¯å¢ƒï¼ˆäºŒçº§åº•åº§ï¼‰

```ba
pyenv virtualenv-delete è™šæ‹Ÿç¯å¢ƒå
```




